# TipTap Editor Visualizations Guide

This guide explains how to use the chart and table visualization features in the TipTap editor.

## Overview

The TipTap editor now supports embedding interactive charts and tables directly in documents. These visualizations can be:
- Created manually using toolbar buttons
- Generated from AI responses
- Edited in-place with live updates
- Exported with the document

## Features

### Chart Node

The ChartNode extension allows embedding various chart types:
- Line charts
- Bar charts
- Area charts
- Pie charts
- Doughnut charts
- Radar charts
- Scatter plots

#### Creating Charts

1. **Using the Toolbar**: Click the chart icon (ðŸ“Š) in the editor toolbar to insert a sample chart
2. **From AI**: When using the Data Visualization Specialist agent in chat, charts can be automatically inserted into the editor

#### Editing Charts

- **Quick Type Change**: Hover over a chart and use the dropdown to change chart type
- **Edit Data**: Click the edit button to modify chart data and configuration in JSON format
- **Delete**: Click the trash button to remove the chart

#### Chart Data Structure

```typescript
interface ChartData {
  labels?: string[];
  datasets?: Array<{
    label: string;
    data: number[];
    backgroundColor?: string | string[];
    borderColor?: string | string[];
    borderWidth?: number;
    fill?: boolean;
    tension?: number;
  }>;
  // For pie/doughnut charts
  values?: Array<{
    name: string;
    value: number;
    color?: string;
  }>;
}

interface ChartConfig {
  type: 'line' | 'bar' | 'pie' | 'doughnut' | 'area' | 'scatter' | 'radar';
  title?: string;
  xAxisLabel?: string;
  yAxisLabel?: string;
  showLegend?: boolean;
  showGrid?: boolean;
  stacked?: boolean;
  aspectRatio?: number;
  colors?: string[];
}
```

### Data Table Node

The DataTableNode extension provides advanced table functionality:
- Sortable columns
- Filterable data
- Pagination
- Footer rows
- Boolean value display

#### Creating Tables

1. **Using the Toolbar**: Click the table icon (âŠž) in the editor toolbar to insert a sample table
2. **From AI**: Tables generated by the Data Visualization Specialist can be inserted automatically

#### Editing Tables

- **Edit Data**: Click the edit button to modify table data and configuration
- **Interactive Features**: Tables support sorting, filtering, and pagination out of the box

#### Table Data Structure

```typescript
interface TableData {
  headers: string[];
  rows: Array<Array<string | number | boolean>>;
  footer?: Array<string | number>;
}

interface TableConfig {
  title?: string;
  sortable?: boolean;
  filterable?: boolean;
  pagination?: boolean;
  pageSize?: number;
  striped?: boolean;
  bordered?: boolean;
  hoverable?: boolean;
  dense?: boolean;
}
```

## Integration with AI

### Using the Data Visualization Specialist

1. In the chat interface, select "Data Visualization Specialist" from the agent dropdown
2. Ask for charts or tables (e.g., "Create a bar chart showing quarterly sales")
3. The AI will generate both the visualization and explanatory text
4. Use the helper functions to insert AI-generated visualizations into the editor:

```typescript
// For charts
import { insertChartFromAI } from '@/components/editor/extensions/ChartNode';
insertChartFromAI(editor, chartData, chartConfig);

// For tables
import { insertDataTableFromAI } from '@/components/editor/extensions/DataTableNode';
insertDataTableFromAI(editor, tableData, tableConfig);
```

## Example Usage

### Sample Chart Creation

```javascript
const sampleData = {
  labels: ['Q1', 'Q2', 'Q3', 'Q4'],
  datasets: [{
    label: 'Revenue',
    data: [30000, 35000, 32000, 40000],
    backgroundColor: 'rgba(59, 130, 246, 0.5)',
    borderColor: 'rgb(59, 130, 246)',
  }]
};

const sampleConfig = {
  type: 'bar',
  title: 'Quarterly Revenue',
  yAxisLabel: 'Revenue ($)',
  showLegend: true,
  showGrid: true
};
```

### Sample Table Creation

```javascript
const sampleData = {
  headers: ['Product', 'Q1', 'Q2', 'Q3', 'Q4', 'Total'],
  rows: [
    ['Product A', 1200, 1500, 1800, 2100, 6600],
    ['Product B', 900, 1100, 1300, 1600, 4900],
  ],
  footer: ['Total', 2100, 2600, 3100, 3700, 11500]
};

const sampleConfig = {
  sortable: true,
  filterable: true,
  pageSize: 10,
  title: 'Sales Report'
};
```

## Best Practices

1. **Keep Data Concise**: Large datasets can slow down the editor
2. **Use Appropriate Chart Types**: Choose visualizations that best represent your data
3. **Provide Context**: Add explanatory text around visualizations
4. **Test Interactivity**: Ensure tables and charts work as expected before saving
5. **Export Considerations**: When exporting to HTML, visualizations are preserved; for text/markdown exports, only data is included

## Troubleshooting

- **Chart Not Rendering**: Check that the data structure matches the expected format
- **Table Sorting Issues**: Ensure data types are consistent within columns
- **Performance**: For large datasets, consider pagination or data aggregation
- **Styling Conflicts**: The visualizations use the app's theme; custom styling may require CSS adjustments

## Future Enhancements

- Additional chart types (heatmaps, treemaps, etc.)
- CSV import/export for tables
- Real-time data connections
- Collaborative editing of visualizations
- Advanced formatting options
